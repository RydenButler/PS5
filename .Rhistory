setwd("~/Dropbox/Courses/Semester4/R/PS5")
library(foreign)
data <- read.dta('anes_timeseries_2012_stata12.dta')
RandomHalf <- sample(1:nrow(data), nrow(data)/2)
Training <- data[RandomHalf, ]
Test <- data[!RandomHalf, ]
lm(ft_dpc ~ interest_attention # pol attentiveness
+ interest_whovote2008 # 2008 pres vote
+ prevote_presvtwho # intended 2012 vote
+ presapp_track # country on right track
+ presapp_job # Obama job approval
+ presapp_econ # Obama econ
+ presapp_foreign # Obama foreign policy
+ presapp_health # Obama health care
+ presapp_war # Obama on Afghanistan
+ health_2010hcr # Favor ACA
+ libcpre_self # 7pt ideology lib->con
+ preswin_win # who will win pres
+ pid_self # pid 1:D; 2:R; 3: Ind; 5: Other; 0: none
+ tea_supp # support tea party 1:Supp; 2:Opp; 3:Neither
, data = Training)
Training$sample_state
class(Training$dt_dpc)
class(Training$ft_dpc)
Training$ft_dpc
summary(Training$ft_dpc)
summary(Training$interest_whovote2008)
mysubset <- data[ , c('dt_dpc', 'interest_whovote2008', 'prevote_presvtwho',
'presapp_track', 'presapp_job', 'presapp_econ',
'presapp_foreign', 'presapp_health', 'presapp_war',
'health_2010hcr', 'libcpre_self', 'preswin_win',
'pid_self', 'tea_supp', 'prevote_reg_state')]
mysubset <- data[ , c('ft_dpc', 'interest_whovote2008', 'prevote_presvtwho',
'presapp_track', 'presapp_job', 'presapp_econ',
'presapp_foreign', 'presapp_health', 'presapp_war',
'health_2010hcr', 'libcpre_self', 'preswin_win',
'pid_self', 'tea_supp', 'prevote_reg_state')]
head(mysubset)
apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
summary(mysubset$interest_whovote2008)
summary(data$interest_whovote2008)
mysubset <- apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-8. Don't know", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-2. Haven't thought much about this", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-9. Refused", NA, x))
mysubset
summary(mysubset)
apply(mysubset, 2, function(x) substr(x, 1, 1))
data <- read.dta('anes_timeseries_2012_stata12.dta')
mysubset <- data[ , c('ft_dpc', 'interest_whovote2008', 'prevote_presvtwho',
'presapp_track', 'presapp_job', 'presapp_econ',
'presapp_foreign', 'presapp_health', 'presapp_war',
'health_2010hcr', 'libcpre_self', 'preswin_win',
'pid_self', 'tea_supp', 'prevote_reg_state')]
# clean data
# handle missingness
mysubset <- apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-8. Don't know", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-2. Haven't thought much about this", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-9. Refused", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "0. No preference {VOL}", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "(Other)", NA, x))
# recode to numeric
mysubset <- apply(mysubset, 2, function(x) substr(x, 1, 1))
mysubset
mysubset[,-1]
mysubset <- data[ , c('ft_dpc', 'interest_whovote2008', 'prevote_presvtwho',
'presapp_track', 'presapp_job', 'presapp_econ',
'presapp_foreign', 'presapp_health', 'presapp_war',
'health_2010hcr', 'libcpre_self', 'preswin_win',
'pid_self', 'tea_supp', 'prevote_reg_state')]
# clean data
# handle missingness
mysubset <- apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-8. Don't know", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-2. Haven't thought much about this", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-9. Refused", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "0. No preference {VOL}", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "(Other)", NA, x))
# recode to numeric
mysubset <- apply(mysubset[,-1], 2, function(x) substr(x, 1, 1))
head(mysubset)
mysubset <- data[ , c('ft_dpc', 'interest_whovote2008', 'prevote_presvtwho',
'presapp_track', 'presapp_job', 'presapp_econ',
'presapp_foreign', 'presapp_health', 'presapp_war',
'health_2010hcr', 'libcpre_self', 'preswin_win',
'pid_self', 'tea_supp', 'prevote_reg_state')]
# clean data
# handle missingness
mysubset <- apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-8. Don't know", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-2. Haven't thought much about this", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-9. Refused", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "0. No preference {VOL}", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "(Other)", NA, x))
# recode to numeric
mysubset[,-1] <- apply(mysubset[,-1], 2, function(x) substr(x, 1, 1))
head(mysubset)
mysubset <- data[ , c('ft_dpc', 'interest_whovote2008', 'prevote_presvtwho',
'presapp_track', 'presapp_job', 'presapp_econ',
'presapp_foreign', 'presapp_health', 'presapp_war',
'health_2010hcr', 'libcpre_self', 'preswin_win',
'pid_self', 'tea_supp', 'prevote_reg_state')]
# clean data
# handle missingness
mysubset <- apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-8. Don't know", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-2. Haven't thought much about this", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-9. Refused", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "0. No preference {VOL}", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "(Other)", NA, x))
# recode to numeric
mysubset[,-1] <- apply(mysubset[,-1], 2, function(x) substr(x, 1, 1))
mysubset <- as.numeric(mysubset)
head(mysubset)
mysubset
mysubset <- data[ , c('ft_dpc', 'interest_whovote2008', 'prevote_presvtwho',
'presapp_track', 'presapp_job', 'presapp_econ',
'presapp_foreign', 'presapp_health', 'presapp_war',
'health_2010hcr', 'libcpre_self', 'preswin_win',
'pid_self', 'tea_supp', 'prevote_reg_state')]
# clean data
# handle missingness
mysubset <- apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-8. Don't know", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-2. Haven't thought much about this", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-9. Refused", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "0. No preference {VOL}", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "(Other)", NA, x))
# recode to numeric
mysubset[,-1] <- apply(mysubset[,-1], 2, function(x) substr(x, 1, 1))
head(mysubset)
mysubset <- apply(mysubset, 2, as.numeric)
head(mysubset)
mysubset <- na.omit(mysubset)
head(mysubset)
RandomHalf <- sample(1:nrow(data), nrow(data)/2)
Training <- data[RandomHalf, ]
Test <- data[!RandomHalf, ]
OLS <- lm(ft_dpc ~ interest_whovote2008 # 2008 pres vote
+ prevote_presvtwho # intended 2012 vote
+ presapp_track # country on right track
+ presapp_job # Obama job approval
+ presapp_econ # Obama econ
+ presapp_foreign # Obama foreign policy
+ presapp_health # Obama health care
+ presapp_war # Obama on Afghanistan
+ health_2010hcr # Favor ACA
+ libcpre_self # 7pt ideology lib->con
+ preswin_win # who will win pres
+ pid_self # pid 1:D; 2:R; 3: Ind; 5: Other; 0: none
+ tea_supp # support tea party 1:Supp; 2:Opp; 3:Neither
+ prevote_reg_state # state voter registered
, data = Training)
OLS
summary(mysubset)
library(foreign)
data <- read.dta('anes_timeseries_2012_stata12.dta')
mysubset <- data[ , c('ft_dpc', 'interest_whovote2008', 'prevote_presvtwho',
'presapp_track', 'presapp_job', 'presapp_econ',
'presapp_foreign', 'presapp_health', 'presapp_war',
'health_2010hcr', 'libcpre_self', 'preswin_win',
'pid_self', 'tea_supp', 'prevote_reg_state')]
# clean data
# handle missingness
mysubset <- apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-8. Don't know", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-2. Haven't thought much about this", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-9. Refused", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "0. No preference {VOL}", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "(Other)", NA, x))
summary(mysubset)
mysubset[,-1] <- apply(mysubset[,-1], 2, function(x) substr(x, 1, 1))
mysubset <- apply(mysubset, 2, as.numeric)
mysubset <- na.omit(mysubset)
RandomHalf <- sample(1:nrow(data), nrow(data)/2)
Training <- data[RandomHalf, ]
Test <- data[!RandomHalf, ]
OLS <- lm(ft_dpc ~ interest_whovote2008 # 2008 pres vote
+ prevote_presvtwho # intended 2012 vote
+ presapp_track # country on right track
+ presapp_job # Obama job approval
+ presapp_econ # Obama econ
+ presapp_foreign # Obama foreign policy
+ presapp_health # Obama health care
+ presapp_war # Obama on Afghanistan
+ health_2010hcr # Favor ACA
+ libcpre_self # 7pt ideology lib->con
+ preswin_win # who will win pres
+ pid_self # pid 1:D; 2:R; 3: Ind; 5: Other; 0: none
+ tea_supp # support tea party 1:Supp; 2:Opp; 3:Neither
+ prevote_reg_state # state voter registered
, data = Training)
library(lme4)
MLM <- lmer(ft_dpc ~ interest_whovote2008 # 2008 pres vote
+ prevote_presvtwho # intended 2012 vote
+ presapp_track # country on right track
+ presapp_job # Obama job approval
+ presapp_econ # Obama econ
+ presapp_foreign # Obama foreign policy
+ presapp_health # Obama health care
+ presapp_war # Obama on Afghanistan
+ health_2010hcr # Favor ACA
+ libcpre_self # 7pt ideology lib->con
+ preswin_win # who will win pres
+ pid_self # pid 1:D; 2:R; 3: Ind; 5: Other; 0: none
+ tea_supp # support tea party 1:Supp; 2:Opp; 3:Neither
+ (1 | prevote_reg_state) # state voter registered
, data = Training)
MLM
summary(MLM)
ranef(MLM)
install.packages('randomforests')
install.packages('randomForests')
install.packages('randomForest')
library(randomForest)
trees <- randomForest(ft_dpc ~ interest_whovote2008 # 2008 pres vote
+ prevote_presvtwho # intended 2012 vote
+ presapp_track # country on right track
+ presapp_job # Obama job approval
+ presapp_econ # Obama econ
+ presapp_foreign # Obama foreign policy
+ presapp_health # Obama health care
+ presapp_war # Obama on Afghanistan
+ health_2010hcr # Favor ACA
+ libcpre_self # 7pt ideology lib->con
+ preswin_win # who will win pres
+ pid_self # pid 1:D; 2:R; 3: Ind; 5: Other; 0: none
+ tea_supp # support tea party 1:Supp; 2:Opp; 3:Neither
+ prevote_reg_state # state voter registered
, data = Training, ntrees = 1000)
mysubset <- apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-8. Don't know", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-2. Haven't thought much about this", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-9. Refused", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "0. No preference {VOL}", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "(Other)", NA, x))
# recode to numeric
mysubset[,-1] <- apply(mysubset[,-1], 2, function(x) substr(x, 1, 1))
mysubset <- apply(mysubset, 2, as.numeric)
mysubset <- na.omit(mysubset)
mysubset <- as.data.frame(mysubset)
head(mysubset)
mysubset <- data[ , c('ft_dpc', 'interest_whovote2008', 'prevote_presvtwho',
'presapp_track', 'presapp_job', 'presapp_econ',
'presapp_foreign', 'presapp_health', 'presapp_war',
'health_2010hcr', 'libcpre_self', 'preswin_win',
'pid_self', 'tea_supp', 'prevote_reg_state')]
# clean data
# handle missingness
mysubset <- apply(mysubset, 2, function(x) ifelse(x == '-1. Inapplicable', NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-8. Don't know", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-2. Haven't thought much about this", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "-9. Refused", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "0. No preference {VOL}", NA, x))
mysubset <- apply(mysubset, 2, function(x) ifelse(x == "(Other)", NA, x))
# recode to numeric
mysubset[,-1] <- apply(mysubset[,-1], 2, function(x) substr(x, 1, 1))
mysubset <- apply(mysubset, 2, as.numeric)
mysubset[,-1] <- apply(mysubset[,-1], 2, as.factor)
mysubset <- na.omit(mysubset)
mysubset <- as.data.frame(mysubset)
head(mysubset)
RandomHalf <- sample(1:nrow(data), nrow(data)/2)
Training <- data[RandomHalf, ]
Test <- data[!RandomHalf, ]
OLS <- lm(ft_dpc ~ interest_whovote2008 # 2008 pres vote
+ prevote_presvtwho # intended 2012 vote
+ presapp_track # country on right track
+ presapp_job # Obama job approval
+ presapp_econ # Obama econ
+ presapp_foreign # Obama foreign policy
+ presapp_health # Obama health care
+ presapp_war # Obama on Afghanistan
+ health_2010hcr # Favor ACA
+ libcpre_self # 7pt ideology lib->con
+ preswin_win # who will win pres
+ pid_self # pid 1:D; 2:R; 3: Ind; 5: Other; 0: none
+ tea_supp # support tea party 1:Supp; 2:Opp; 3:Neither
+ prevote_reg_state # state voter registered
, data = Training)
library(lme4)
MLM <- lmer(ft_dpc ~ interest_whovote2008 # 2008 pres vote
+ prevote_presvtwho # intended 2012 vote
+ presapp_track # country on right track
+ presapp_job # Obama job approval
+ presapp_econ # Obama econ
+ presapp_foreign # Obama foreign policy
+ presapp_health # Obama health care
+ presapp_war # Obama on Afghanistan
+ health_2010hcr # Favor ACA
+ libcpre_self # 7pt ideology lib->con
+ preswin_win # who will win pres
+ pid_self # pid 1:D; 2:R; 3: Ind; 5: Other; 0: none
+ tea_supp # support tea party 1:Supp; 2:Opp; 3:Neither
+ (1 | prevote_reg_state) # state voter registered
, data = Training)
summary(MLM)
ranef(MLM)
library(randomForest)
trees <- randomForest(ft_dpc ~ interest_whovote2008 # 2008 pres vote
+ prevote_presvtwho # intended 2012 vote
+ presapp_track # country on right track
+ presapp_job # Obama job approval
+ presapp_econ # Obama econ
+ presapp_foreign # Obama foreign policy
+ presapp_health # Obama health care
+ presapp_war # Obama on Afghanistan
+ health_2010hcr # Favor ACA
+ libcpre_self # 7pt ideology lib->con
+ preswin_win # who will win pres
+ pid_self # pid 1:D; 2:R; 3: Ind; 5: Other; 0: none
+ tea_supp # support tea party 1:Supp; 2:Opp; 3:Neither
+ prevote_reg_state # state voter registered
, data = Training, ntrees = 1000)
class(Training$ft_dpc)
trees <- randomForest(ft_dpc ~ interest_whovote2008 # 2008 pres vote
+ prevote_presvtwho # intended 2012 vote
+ presapp_track # country on right track
+ presapp_job # Obama job approval
+ presapp_econ # Obama econ
+ presapp_foreign # Obama foreign policy
+ presapp_health # Obama health care
+ presapp_war # Obama on Afghanistan
+ health_2010hcr # Favor ACA
+ libcpre_self # 7pt ideology lib->con
+ preswin_win # who will win pres
+ pid_self # pid 1:D; 2:R; 3: Ind; 5: Other; 0: none
+ tea_supp # support tea party 1:Supp; 2:Opp; 3:Neither
, data = Training, ntrees = 1000)
summary(trees)
predict(MLM, Test)
predict(tress, Test)
predict(trees, Test)
